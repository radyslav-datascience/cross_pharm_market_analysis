# WORK HISTORY - cross_pharm_market_analysis

> **–í–µ—Ä—Å—ñ—è:** 2.0 | **–û–Ω–æ–≤–ª–µ–Ω–æ:** 13.02.2026

**–ü—Ä–æ–µ–∫—Ç:** –ú—É–ª—å—Ç–∏-—Ä–∏–Ω–∫–æ–≤–∏–π –∞–Ω–∞–ª—ñ–∑ —Å—É–±—Å—Ç–∏—Ç—É—Ü—ñ—ó –ø—Ä–µ–ø–∞—Ä–∞—Ç—ñ–≤ (50+ –ª–æ–∫–∞–ª—å–Ω–∏—Ö —Ä–∏–Ω–∫—ñ–≤)

---

## –Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è –≤–µ–¥–µ–Ω–Ω—è

–¶–µ–π —Ñ–∞–π–ª –º—ñ—Å—Ç–∏—Ç—å —ñ—Å—Ç–æ—Ä—ñ—é —Ä–æ–±—ñ—Ç –ø—Ä–æ–µ–∫—Ç—É –≤ **–ó–í–û–†–û–¢–ù–¨–û–ú–£ —Ö—Ä–æ–Ω–æ–ª–æ–≥—ñ—á–Ω–æ–º—É –ø–æ—Ä—è–¥–∫—É** (–Ω–∞–π–Ω–æ–≤—ñ—à—ñ –∑–º—ñ–Ω–∏ –∑–≤–µ—Ä—Ö—É).

### –ü—Ä–∏–Ω—Ü–∏–ø–∏ –≤–µ–¥–µ–Ω–Ω—è:
- –§—ñ–∫—Å—É–≤–∞—Ç–∏ **–ø—Ä–æ—Ü–µ—Å —Ä–æ–±–æ—Ç–∏**, –∞ –Ω–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è
- –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ñ —á–∏—Å–ª–∞ —Ç–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ ‚Äî –≤ outputs –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —É–∑–∞–≥–∞–ª—å–Ω–µ–Ω—ñ –ø–∞—Ç–µ—Ä–Ω–∏ –∑–∞–º—ñ—Å—Ç—å —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω–∏—Ö ID

### –§–æ—Ä–º–∞—Ç –∑–∞–ø–∏—Å—É:
```
## YYYY-MM-DD - –ù–∞–∑–≤–∞ –µ—Ç–∞–ø—É ‚úÖ/‚ö†Ô∏è/üîÑ

### –í–∏–∫–æ–Ω–∞–Ω–æ:
- –©–æ –∑—Ä–æ–±–ª–µ–Ω–æ (–±–µ–∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏—Ö —á–∏—Å–µ–ª)

### Output:
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å—Ç–≤–æ—Ä–µ–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤ (–ø–∞—Ç–µ—Ä–Ω)

### –û–Ω–æ–≤–ª–µ–Ω—ñ —Ñ–∞–π–ª–∏:
- –°–ø–∏—Å–æ–∫ —Ñ–∞–π–ª—ñ–≤ –∑ –≤–µ—Ä—Å—ñ—è–º–∏

### –°—Ç–∞—Ç—É—Å: ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û / ‚ö†Ô∏è –í –†–û–ë–û–¢–Ü / üîÑ –û–ù–û–í–õ–ï–ù–û
### –ù–∞—Å—Ç—É–ø–Ω–∏–π –∫—Ä–æ–∫: –©–æ —Ä–æ–±–∏—Ç–∏ –¥–∞–ª—ñ
```

---

## 2026-02-13 - –ü–∞—Ä–∞–ª–µ–ª—ñ–∑–∞—Ü—ñ—è, sub_drugs feature, –ø–æ–≤–Ω–∏–π GitHub upload, README ‚úÖ

### –í–∏–∫–æ–Ω–∞–Ω–æ:

**1. –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ ‚Äî 3-—Ä—ñ–≤–Ω–µ–≤–∞ –ø–∞—Ä–∞–ª–µ–ª—ñ–∑–∞—Ü—ñ—è (Level 3)**
- –†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ INN-–ø–∞—Ä–∞–ª–µ–ª—ñ–∑–º (Level 3) —á–µ—Ä–µ–∑ ThreadPoolExecutor (2 –ø–æ—Ç–æ–∫–∏ –Ω–∞ –≤–æ—Ä–∫–µ—Ä)
- –ü–æ–≤–Ω–∞ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ –ø–∞—Ä–∞–ª–µ–ª—ñ–∑–∞—Ü—ñ—ó:
  - Level 1: ProcessPoolExecutor (5 –≤–æ—Ä–∫–µ—Ä—ñ–≤) ‚Äî –ø–∞—Ä–∞–ª–µ–ª—å–Ω–∞ –æ–±—Ä–æ–±–∫–∞ —Ä–∏–Ω–∫—ñ–≤
  - Level 2: Sequential INN processing –≤ –∫–æ–∂–Ω–æ–º—É –≤–æ—Ä–∫–µ—Ä—ñ
  - Level 3: ThreadPoolExecutor (2 –ø–æ—Ç–æ–∫–∏) ‚Äî –ø–∞—Ä–∞–ª–µ–ª—å–Ω–∞ –æ–±—Ä–æ–±–∫–∞ INN –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –≤–æ—Ä–∫–µ—Ä–∞
- –ü—Ä–æ–≤–µ–¥–µ–Ω–æ 4 performance —Ç–µ—Å—Ç–∏, –Ω–∞–π–∫—Ä–∞—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: **7 —Ö–≤ 04.6 —Å–µ–∫** (–Ω–∞ AC power)
- –î–æ—Å—è–≥–Ω—É—Ç–æ **3.3√ó –ø—Ä–∏—Å–∫–æ—Ä–µ–Ω–Ω—è** (–∑ ~23 —Ö–≤ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—ó –æ–±—Ä–æ–±–∫–∏)
- –ó–∞–∫—Ä–∏—Ç–æ Level 4 (Polars) —è–∫ –Ω–µ–≤–∞—Ä—Ç—ñ—Å–Ω–∏–π ‚Äî pandas –¥–æ—Å—Ç–∞—Ç–Ω—å–æ —à–≤–∏–¥–∫–∏–π
- –û–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω–æ 10 –∑–∞–¥–∞—á (memory management, GIL handling, tqdm progress bars)

**2. –ù–æ–≤–∞ feature: sub_drugs ‚Äî –¥–µ—Ç–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ –ø–∞—Ä–∏ –∑–∞–º—ñ–Ω–Ω–∏–∫—ñ–≤**
- –°—Ç–≤–æ—Ä–µ–Ω–æ `create_sub_drugs_csv()` ‚Äî flat CSV –∑ –¥–µ—Ç–∞–ª—å–Ω–∏–º–∏ –ø–∞—Ä–∞–º–∏ (stockout drug ‚Üí substitute drug)
- –ü–µ—Ä–µ–π–º–µ–Ω–æ–≤–∞–Ω–æ `create_cross_market_csv()` ‚Üí `create_sub_coef_csv()` (–∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç–∏ —Å—É–±—Å—Ç–∏—Ç—É—Ü—ñ—ó)
- –ù–æ–≤–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤–∏–≤–æ–¥—É ‚Äî per-market –ø—ñ–¥–ø–∞–ø–∫–∏:
  ```
  results/cross_market_data/market_substitution_{ID}/
  ‚îú‚îÄ‚îÄ sub_coef_{ID}.csv    # –ö–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç–∏ —Å—É–±—Å—Ç–∏—Ç—É—Ü—ñ—ó (—Ä–∞–Ω—ñ—à–µ cross_market_{ID}.csv)
  ‚îî‚îÄ‚îÄ sub_drugs_{ID}.csv   # –î–µ—Ç–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ –ø–∞—Ä–∏ –∑–∞–º—ñ–Ω–Ω–∏–∫—ñ–≤ (–ù–û–í–ï)
  ```
- –û–Ω–æ–≤–ª–µ–Ω–æ `01_data_preparation.py` ‚Äî glob pattern —Ç–∞ parsing –¥–ª—è –Ω–æ–≤–æ—ó —Å—Ç—Ä—É–∫—Ç—É—Ä–∏
- –ü—Ä–æ—Ç–µ—Å—Ç–æ–≤–∞–Ω–æ –Ω–∞ –≤—Å—ñ—Ö 10 —Ä–∏–Ω–∫–∞—Ö: 1675 drugs, 23222 substitute pairs
- –í–∞–ª—ñ–¥–∞—Ü—ñ—è: SHARE decimal —Ñ–æ—Ä–º–∞—Ç, RANK ordering, drug count match ‚Äî **ALL PASSED**

**3. –ü–æ–≤–Ω–∏–π upload –ø—Ä–æ–µ–∫—Ç—É –Ω–∞ GitHub**
- –í–∏—è–≤–ª–µ–Ω–æ –ø—Ä–æ–±–ª–µ–º—É: 378 —ñ–∑ 460 —Ñ–∞–π–ª—ñ–≤ (82%) –±—É–ª–∏ –≤—ñ–¥—Å—É—Ç–Ω—ñ –Ω–∞ GitHub —á–µ—Ä–µ–∑ .gitignore
- –ó–∞–±–ª–æ–∫–æ–≤–∞–Ω—ñ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó: `data/raw/`, `data/processed_data/`, `results/cross_market_data/`, `results/data_reports/`, `results/substitution_research/`
- –í–∏–ø—Ä–∞–≤–ª–µ–Ω–æ .gitignore ‚Äî –≤–∏–¥–∞–ª–µ–Ω–æ 5 –ø—Ä–∞–≤–∏–ª –±–ª–æ–∫—É–≤–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö —Ç–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤
- –í–∏–¥–∞–ª–µ–Ω–æ 5 –∑–∞–π–≤–∏—Ö .gitkeep placeholder —Ñ–∞–π–ª—ñ–≤ (–ø–∞–ø–∫–∏ —Ç–µ–ø–µ—Ä –º—ñ—Å—Ç—è—Ç—å —Ä–µ–∞–ª—å–Ω—ñ —Ñ–∞–π–ª–∏)
- –î–æ–¥–∞–Ω–æ –≤—Å—ñ 378 —Ñ–∞–π–ª—ñ–≤ —á–µ—Ä–µ–∑ `git add -A`
- –í–µ—Ä–∏—Ñ—ñ–∫–∞—Ü—ñ—è: **455 –ª–æ–∫–∞–ª—å–Ω–∏—Ö = 455 tracked, 0 missing, 0 extra** ‚Äî —ñ–¥–µ–∞–ª—å–Ω–∏–π 1:1 –∑–±—ñ–≥

**4. –ö–æ–º–ø–ª–µ–∫—Å–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è README.md**
- –°—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç—É: "In Development" ‚Üí **"Completed"** (–∑–µ–ª–µ–Ω–∏–π badge)
- –ó–∞–≥–æ–ª–æ–≤–æ–∫: –¥–æ–¥–∞–Ω–æ "with Parallel Computing"
- –ù–æ–≤–∞ —Å–µ–∫—Ü—ñ—è **"üìä Research Results"**: summary –¥–∞—Ç–∞—Å–µ—Ç—É, –∫–ª—é—á–æ–≤—ñ –∑–Ω–∞—Ö—ñ–¥–∫–∏, –≤–∏—Å–Ω–æ–≤–∫–∏
- –ù–æ–≤–∞ —Å–µ–∫—Ü—ñ—è **"‚ö° Parallel Computing"**: 3-—Ä—ñ–≤–Ω–µ–≤–∞ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞, 3.3√ó speedup
- –û–Ω–æ–≤–ª–µ–Ω–æ pipeline –¥—ñ–∞–≥—Ä–∞–º—É, Technical Stack (Python 3.13, tqdm, ThreadPoolExecutor)
- –û–Ω–æ–≤–ª–µ–Ω–æ Project Structure —Ç–∞ Data Privacy —Å–µ–∫—Ü—ñ—ó
- –í–∏–ø—Ä–∞–≤–ª–µ–Ω–æ broken Unicode emoji (U+FFFD) –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∞—Ö —Å–µ–∫—Ü—ñ–π

### Output:
```
results/cross_market_data/
‚îú‚îÄ‚îÄ market_substitution_28670/
‚îÇ   ‚îú‚îÄ‚îÄ sub_coef_28670.csv
‚îÇ   ‚îî‚îÄ‚îÄ sub_drugs_28670.csv
‚îú‚îÄ‚îÄ market_substitution_28753/
‚îÇ   ‚îú‚îÄ‚îÄ sub_coef_28753.csv
‚îÇ   ‚îî‚îÄ‚îÄ sub_drugs_28753.csv
‚îú‚îÄ‚îÄ ... (10 —Ä–∏–Ω–∫—ñ–≤)

GitHub: 455 —Ñ–∞–π–ª—ñ–≤, –ø–æ–≤–Ω–∏–π 1:1 clone –ø—Ä–æ–µ–∫—Ç—É
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
- –û–±—Ä–æ–±–ª–µ–Ω–æ: 10 —Ç–µ—Å—Ç–æ–≤–∏—Ö —Ä–∏–Ω–∫—ñ–≤ (108139, 129455, 1336951, 1419760, 28670, 28753, 416188, 493281, 584900, 98911)
- –ß–∞—Å –æ–±—Ä–æ–±–∫–∏: 7 —Ö–≤ 05 —Å–µ–∫ (3.3√ó –ø—Ä–∏—Å–∫–æ—Ä–µ–Ω–Ω—è)
- sub_coef: 1675 drugs, 904 SUBSTITUTABLE + 771 CRITICAL
- sub_drugs: 23222 substitute pairs
- Phase 2 –≤–∞–ª—ñ–¥–∞—Ü—ñ—è: 611 drugs, 353 researched, 10 markets ‚Äî **PASSED**
- Git commits: `26800e5` ‚Üí `529184e` ‚Üí `f5eb0db` ‚Üí `87baf07`

### –û–Ω–æ–≤–ª–µ–Ω—ñ —Ñ–∞–π–ª–∏:
- `exec_scripts/01_did_processing/02_05_reports_cross_market.py` ‚Äî sub_coef + sub_drugs, –Ω–æ–≤–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫
- `exec_scripts/02_substitution_coefficients/01_data_preparation.py` ‚Äî glob pattern –¥–ª—è –Ω–æ–≤–æ—ó —Å—Ç—Ä—É–∫—Ç—É—Ä–∏
- `exec_scripts/01_did_processing/02_03_did_analysis.py` ‚Äî INN-–ø–∞—Ä–∞–ª–µ–ª—ñ–∑–º (ThreadPoolExecutor)
- `exec_scripts/01_did_processing/02_04_substitute_analysis.py` ‚Äî INN-–ø–∞—Ä–∞–ª–µ–ª—ñ–∑–º (ThreadPoolExecutor)
- `project_core/did_config/machine_parameters.py` ‚Äî –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –ø–∞—Ä–∞–ª–µ–ª—ñ–∑–∞—Ü—ñ—ó
- `exec_scripts/01_did_processing/parallel_runner.py` ‚Äî tqdm progress bars
- `.gitignore` ‚Äî –≤–∏–¥–∞–ª–µ–Ω–æ –±–ª–æ–∫—É–≤–∞–Ω–Ω—è data/ —Ç–∞ results/
- `README.md` ‚Äî Completed status, Research Results, Parallel Computing
- `docs/_project_history/00_WORK_HISTORY.md` (v2.0)

### –°—Ç–∞—Ç—É—Å: ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û
### –ù–∞—Å—Ç—É–ø–Ω–∏–π –∫—Ä–æ–∫: –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ä–µ—à—Ç—É —Ä–∏–Ω–∫—ñ–≤ —ñ–∑ 99 —Ç–∞ –ø—Ä–æ–≤–µ—Å—Ç–∏ –º–∞—Å–æ–≤–µ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è –≤—Å—ñ—Ö —Ä–∏–Ω–∫—ñ–≤

---

## 2026-02-10 - Deep Audit –ø—Ä–æ–µ–∫—Ç—É + Phase 2 xlsx –¥–æ–æ–ø—Ä–∞—Ü—é–≤–∞–Ω–Ω—è ‚úÖ

### –í–∏–∫–æ–Ω–∞–Ω–æ:

**1. –ì–ª–∏–±–æ–∫–∏–π –∞—É–¥–∏—Ç –ø—Ä–æ–µ–∫—Ç—É –ø—ñ—Å–ª—è –ø–µ—Ä–µ–π–º–µ–Ω—É–≤–∞–Ω–Ω—è**
- –í–∏–∫–æ–Ω–∞–Ω–æ –ø–æ–≤–Ω–∏–π –∞—É–¥–∏—Ç –≤—Å—ñ—Ö —Ñ–∞–π–ª—ñ–≤ –ø—Ä–æ–µ–∫—Ç—É –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –∑–∞—Å—Ç–∞—Ä—ñ–ª–∏—Ö –ø–æ—Å–∏–ª–∞–Ω—å –ø—ñ—Å–ª—è —Ä–µ–Ω–µ–π–º—ñ–Ω–≥—É `mass_market_analysis_test` ‚Üí `cross_pharm_market_analysis`
- –í–∏—è–≤–ª–µ–Ω–æ **13 –∫–∞—Ç–µ–≥–æ—Ä—ñ–π –ø—Ä–æ–±–ª–µ–º** (—Å—Ç–∞—Ä–æ–¥–∞–≤–Ω—ñ —ñ–º–µ–Ω–∞, —à–ª—è—Ö–∏, —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ–π)
- –í–∏–ø—Ä–∞–≤–ª–µ–Ω–æ **35+ —Ñ–∞–π–ª—ñ–≤** —É —Ç—Ä—å–æ—Ö –∑–æ–Ω–∞—Ö:
  - `docs/` ‚Äî 17 —Ñ–∞–π–ª—ñ–≤ (ai_rules, did_processing, substitution_coefficients, project_history, values_describe)
  - `project_core/` ‚Äî 13 —Ñ–∞–π–ª—ñ–≤ (headers, docstrings, print statements, import paths, error messages)
  - `exec_scripts/` ‚Äî 6 —Ñ–∞–π–ª—ñ–≤ (headers, file paths, usage examples, help text)
- –í–µ—Ä–∏—Ñ—ñ–∫–∞—Ü—ñ—è: grep –ø–æ –≤—Å—ñ—Ö –∞–∫—Ç–∏–≤–Ω–∏—Ö —Ñ–∞–π–ª–∞—Ö ‚Äî —Å—Ç–∞—Ä–æ–¥–∞–≤–Ω—ñ –ø–∞—Ç–µ—Ä–Ω–∏ –≤–∏–¥–∞–ª–µ–Ω—ñ –ø–æ–≤–Ω—ñ—Å—Ç—é
- –Ü—Å—Ç–æ—Ä–∏—á–Ω—ñ –∑–∞–ø–∏—Å–∏ –≤ `00_WORK_HISTORY.md` —Ç–∞ `_temp_project_plan/` –∑–±–µ—Ä–µ–∂–µ–Ω—ñ —è–∫ —î

**2. –†–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏–∑–∞—Ü—ñ—è `_values_describe` –ø–∞–ø–æ–∫**
- `docs/_values_describe/` (5 —Ñ–∞–π–ª—ñ–≤ Phase 1) ‚Üí `docs/01_did_processing/_did_values_describe/`
- `results/substitution_research/_values_describe/` (1 —Ñ–∞–π–ª Phase 2) ‚Üí `docs/02_substitution_coefficients/_substitution_values_describe/`
- `data/processed_data/_values_describe/` (–ø–æ—Ä–æ–∂–Ω—è) ‚Üí –≤–∏–¥–∞–ª–µ–Ω–∞
- –û–Ω–æ–≤–ª–µ–Ω–æ –¥–µ—Ä–µ–≤–æ –ø—Ä–æ–µ–∫—Ç—É –≤ `00_CLAUDE_RULES.md`
- –û–Ω–æ–≤–ª–µ–Ω–æ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –≤ `03_DATA_PREPARATION_AND_OUTPUTS.md`

**3. –î–æ–æ–ø—Ä–∞—Ü—é–≤–∞–Ω–Ω—è –±—ñ–∑–Ω–µ—Å-–∑–≤—ñ—Ç—É `researched_drugs_coefficients.xlsx`**
- –í–∏–¥–∞–ª–µ–Ω–æ —Ç–µ—Ö–Ω—ñ—á–Ω—ñ –∫–æ–ª–æ–Ω–∫–∏ –∑ xlsx: `INTERNAL_LIFT_LOC_{ID}` (5 —à—Ç.) —Ç–∞ `EVENTS_COUNT_LOC_{ID}` (5 —à—Ç.)
- xlsx: 11 –±—ñ–∑–Ω–µ—Å-–∫–æ–ª–æ–Ω–æ–∫ (–±—É–ª–æ 21), CSV: 21 –∫–æ–ª–æ–Ω–∫–∞ (–±–µ–∑ –∑–º—ñ–Ω, –¥–ª—è —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—ñ–≤)
- `SHARE_INTERNAL_LOC_{ID}` –≤—ñ–¥—Ñ–æ—Ä–º–∞—Ç–æ–≤–∞–Ω–æ —è–∫ –≤—ñ–¥—Å–æ—Ç–∫–∏ —á–µ—Ä–µ–∑ openpyxl (`0.00%` number format)
- –ó–Ω–∞—á–µ–Ω–Ω—è –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è —è–∫ float 0.0‚Äì1.0 (—Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è/—Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –ø—Ä–∞—Ü—é—é—Ç—å), –≤—ñ–¥–æ–±—Ä–∞–∂–∞—é—Ç—å—Å—è —è–∫ `36.74%`

**4. –í–µ—Ä–∏—Ñ—ñ–∫–∞—Ü—ñ—è xlsx (9 –∫–∞—Ç–µ–≥–æ—Ä—ñ–π –ø–µ—Ä–µ–≤—ñ—Ä–æ–∫)**
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞, —Ç–∏–ø–∏ –¥–∞–Ω–∏—Ö, –¥—ñ–∞–ø–∞–∑–æ–Ω–∏ SHARE, —Ç—Ä–∏–∫—É—Ç–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞, Excel-—Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è, –≤—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å —Ç–µ—Ö–Ω—ñ—á–Ω–∏—Ö –∫–æ–ª–æ–Ω–æ–∫, –∑–±—ñ–≥ –∑ CSV (max_diff=0.0), –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ñ—Å—Ç—å MARKET_COUNT, —Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è
- **ALL CHECKS PASSED**

### Output:
```
results/substitution_research/01_preparation/
‚îú‚îÄ‚îÄ researched_drugs_coefficients.csv       # 289 √ó 21 (—Ç–µ—Ö–Ω—ñ—á–Ω–∏–π, –ø–æ–≤–Ω–∏–π)
‚îî‚îÄ‚îÄ prep_business_reports/
    ‚îî‚îÄ‚îÄ researched_drugs_coefficients.xlsx   # 289 √ó 11 (–±—ñ–∑–Ω–µ—Å, SHARE —è–∫ %)

docs/01_did_processing/
‚îî‚îÄ‚îÄ _did_values_describe/                   # 5 —Ñ–∞–π–ª—ñ–≤ (–ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–æ –∑ docs/_values_describe/)

docs/02_substitution_coefficients/
‚îî‚îÄ‚îÄ _substitution_values_describe/          # 1 —Ñ–∞–π–ª (–ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–æ –∑ results/)
```

### –û–Ω–æ–≤–ª–µ–Ω—ñ —Ñ–∞–π–ª–∏:
- `exec_scripts/02_substitution_coefficients/01_data_preparation.py` ‚Äî export_to_xlsx() –¥–æ–æ–ø—Ä–∞—Ü—å–æ–≤–∞–Ω–æ
- `docs/00_ai_rules/00_CLAUDE_RULES.md` ‚Äî –æ–Ω–æ–≤–ª–µ–Ω–µ –¥–µ—Ä–µ–≤–æ –ø—Ä–æ–µ–∫—Ç—É
- `docs/00_ai_rules/01_BUSINESS_CONTEXT.md` ‚Äî –≤–∏–ø—Ä–∞–≤–ª–µ–Ω—ñ —à–ª—è—Ö–∏ —Ç–∞ –Ω–∞–∑–≤–∏
- `docs/00_ai_rules/02_KNOWN_ISSUES.md` ‚Äî –≤–∏–ø—Ä–∞–≤–ª–µ–Ω—ñ –Ω–∞–∑–≤–∏
- `docs/00_ai_rules/03_PROJECT_MAP.md` ‚Äî –≤–∏–ø—Ä–∞–≤–ª–µ–Ω—ñ —à–ª—è—Ö–∏
- `docs/00_ai_rules/04_DOCUMENTATION_PRINCIPLES.md` ‚Äî –≤–∏–ø—Ä–∞–≤–ª–µ–Ω—ñ —à–ª—è—Ö–∏
- `docs/01_did_processing/` ‚Äî 7 —Ñ–∞–π–ª—ñ–≤ + 4 _did_processing_instructions (—à–ª—è—Ö–∏, –Ω–∞–∑–≤–∏)
- `docs/02_substitution_coefficients/` ‚Äî 3 —Ñ–∞–π–ª–∏ (—à–ª—è—Ö–∏, –ø–æ—Å–∏–ª–∞–Ω–Ω—è)
- `docs/_values_describe/` ‚Äî 2 —Ñ–∞–π–ª–∏ (—à–ª—è—Ö–∏ exec_scripts)
- `project_core/` ‚Äî 13 —Ñ–∞–π–ª—ñ–≤ (headers, docstrings, imports, error messages)
- `exec_scripts/01_did_processing/` ‚Äî 6 —Ñ–∞–π–ª—ñ–≤ (headers, paths, usage)
- `docs/_project_history/00_WORK_HISTORY.md` (v1.9)

### –°—Ç–∞—Ç—É—Å: ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û
### –ù–∞—Å—Ç—É–ø–Ω–∏–π –∫—Ä–æ–∫: Phase 2 Step 2 ‚Äî —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –∑–≤–∞–∂–µ–Ω–∏—Ö –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç—ñ–≤ —Å—É–±—Å—Ç–∏—Ç—É—Ü—ñ—ó

---

## 2026-01-31 - Deep Audit —Ç–∞ –≤–µ—Ä–∏—Ñ—ñ–∫–∞—Ü—ñ—è Pipeline Phase 1 ‚úÖ

### –í–∏–∫–æ–Ω–∞–Ω–æ:
**–ì–ª–∏–±–æ–∫–∏–π –∞—É–¥–∏—Ç –≤—Å—ñ—Ö 5 –∫—Ä–æ–∫—ñ–≤ Pipeline Phase 1** ‚Äî –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è —Ñ–æ—Ä–º—É–ª line-by-line –∑ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–º–∏ notebooks –∑ `med_prod_research/research_notebooks/`.

**–í–∏—è–≤–ª–µ–Ω–æ —Ç–∞ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–æ 4 —Ä–æ–∑–±—ñ–∂–Ω–æ—Å—Ç—ñ:**

| –ö—Ä–æ–∫ | –ü—Ä–æ–±–ª–µ–º–∞ | –í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è |
|------|----------|-------------|
| Step 2 | Level 1 –≤–∞–ª—ñ–¥–∞—Ü—ñ—è –Ω–∞ —Ä—ñ–≤–Ω—ñ DRUG –∑–∞–º—ñ—Å—Ç—å INN | –í–∏–ø—Ä–∞–≤–ª–µ–Ω–æ: –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ `MARKET_TOTAL_DRUGS_PACK` –Ω–∞ —Ä—ñ–≤–Ω—ñ **INN –≥—Ä—É–ø–∏** |
| Step 3 | MARKET_GROWTH –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–≤ `Q` –∑–∞–º—ñ—Å—Ç—å `MARKET_TOTAL_DRUGS_PACK` | –í–∏–ø—Ä–∞–≤–ª–µ–Ω–æ: –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ **—Ä–∏–Ω–∫–æ–≤—ñ –¥–∞–Ω—ñ** (–∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–∏) |
| Step 4 | –í—ñ–¥—Å—É—Ç–Ω—ñ –∫–æ–ª–æ–Ω–∫–∏ `INN_ID`, `INN_NAME` –≤ output | –î–æ–¥–∞–Ω–æ –¥–ª—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—ñ –∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—î—é |
| Step 5 | AGG_SHARE —Ä–æ–∑—Ä–∞—Ö–æ–≤—É–≤–∞–≤—Å—è —è–∫ mean –∑–∞–º—ñ—Å—Ç—å ratio —Å—É–º | –í–∏–ø—Ä–∞–≤–ª–µ–Ω–æ: `TOTAL_LIFT_X / INTERNAL_LIFT` (weighted average) |

**–û–Ω–æ–≤–ª–µ–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—é:**
- `02_STOCKOUT_DETECTION.md` ‚Äî –¥–æ–¥–∞–Ω–æ —Å–µ–∫—Ü—ñ—é 4.4 "–†—ñ–≤–Ω—ñ –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó: –¥–µ—Ç–∞–ª—ñ"
- `03_DID_NFC_ANALYSIS.md` ‚Äî –¥–æ–¥–∞–Ω–æ —Å–µ–∫—Ü—ñ—é 6.1 "MARKET_GROWTH: –¥–µ—Ç–∞–ª—ñ —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É"

**–í—Å—ñ 5 –∫—Ä–æ–∫—ñ–≤ —É—Å–ø—ñ—à–Ω–æ –≤–µ—Ä–∏—Ñ—ñ–∫–æ–≤–∞–Ω—ñ:**
- Step 1: –§–æ—Ä–º—É–ª–∏ —ñ–¥–µ–Ω—Ç–∏—á–Ω—ñ –æ—Ä–∏–≥—ñ–Ω–∞–ª—É
- Step 2: 9,645 –≤–∞–ª—ñ–¥–Ω–∏—Ö –ø–æ–¥—ñ–π (82.9%)
- Step 3: 8,216 DiD –ø–æ–¥—ñ–π (85.2%), AVG SHARE_INTERNAL 52.6%
- Step 4: 8,287 substitute pairs, AVG SAME_NFC1 77.9%
- Step 5: 773 drugs, 5 markets, –≤–∞–ª—ñ–¥–∞—Ü—ñ—è SHARE=100% OK

### –û–Ω–æ–≤–ª–µ–Ω—ñ —Ñ–∞–π–ª–∏:
- `exec_scripts/02_02_stockout_detection.py` (Level 1 validation fix)
- `exec_scripts/02_03_did_analysis.py` (MARKET_GROWTH fix)
- `exec_scripts/02_04_substitute_analysis.py` (INN_ID/INN_NAME added)
- `exec_scripts/02_05_reports_cross_market.py` (AGG_SHARE ratio fix)
- `docs/01_did_processing/02_STOCKOUT_DETECTION.md` (v1.1)
- `docs/01_did_processing/03_DID_NFC_ANALYSIS.md` (v1.1)
- `docs/_temp_project_plan/01_autonomous_project_plan.md` (checklist updated)
- `docs/_temp_project_plan/02_refactoring_algorithm.md` (all steps VERIFIED)

### –°—Ç–∞—Ç—É—Å: ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û (Phase 1 –≤–µ—Ä–∏—Ñ—ñ–∫–∞—Ü—ñ—è –ø–æ–≤–Ω—ñ—Å—Ç—é –∑–∞–≤–µ—Ä—à–µ–Ω–∞!)
### –ù–∞—Å—Ç—É–ø–Ω–∏–π –∫—Ä–æ–∫: Phase 1.3 ‚Äî –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—è (run_full_pipeline.py, logging) –∞–±–æ Phase 2 ‚Äî Cross-Market Aggregation

---

## 2026-01-28 - Phase 1 Step 5: Reports Generation ‚úÖ

### –í–∏–∫–æ–Ω–∞–Ω–æ:
- –°—Ç–≤–æ—Ä–µ–Ω–æ —Å–∫—Ä–∏–ø—Ç `exec_scripts/02_05_reports_cross_market.py`
- –†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—é 3 —Ç–∏–ø—ñ–≤ –≤–∏—Ö—ñ–¥–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤ –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ —Ä–∏–Ω–∫—É:
  - **01_technical_report_{CLIENT_ID}.xlsx** ‚Äî –ø–æ–≤–Ω–∏–π —Ç–µ—Ö–Ω—ñ—á–Ω–∏–π –∑–≤—ñ—Ç (27 –∫–æ–ª–æ–Ω–æ–∫)
  - **02_business_report_{CLIENT_ID}.xlsx** ‚Äî —Å–ø—Ä–æ—â–µ–Ω–∏–π –±—ñ–∑–Ω–µ—Å-–∑–≤—ñ—Ç (18 –∫–æ–ª–æ–Ω–æ–∫)
  - **cross_market_{CLIENT_ID}.csv** ‚Äî flat data –¥–ª—è cross-market –∞–≥—Ä–µ–≥–∞—Ü—ñ—ó (21 –∫–æ–ª–æ–Ω–∫–∞)
- –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç —Å—É–±—Å—Ç–∏—Ç—É—Ç—ñ–≤ (–∫–æ–∂–µ–Ω substitute = –æ–∫—Ä–µ–º–∏–π —Ä—è–¥–æ–∫)
- –ö–æ–ª—å–æ—Ä–æ–≤–µ –º–∞—Ä–∫—É–≤–∞–Ω–Ω—è –∫–∞—Ç–µ–≥–æ—Ä—ñ–π (CRITICAL ‚Äî —á–µ—Ä–≤–æ–Ω–∏–π, SUBSTITUTABLE ‚Äî –∑–µ–ª–µ–Ω–∏–π)
- –°–æ—Ä—Ç—É–≤–∞–Ω–Ω—è: CRITICAL —Å–ø–æ—á–∞—Ç–∫—É, –ø–æ—Ç—ñ–º –ø–æ SHARE_LOST —Å–ø–∞–¥–∞—é—á–∏
- –ü—Ä–æ—Ç–µ—Å—Ç–æ–≤–∞–Ω–æ –Ω–∞ –≤—Å—ñ—Ö 5 —Ä–∏–Ω–∫–∞—Ö

### Output:
```
results/
‚îú‚îÄ‚îÄ data_reports/
‚îÇ   ‚îú‚îÄ‚îÄ reports_28670/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 01_technical_report_28670.xlsx
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ 02_business_report_28670.xlsx
‚îÇ   ‚îú‚îÄ‚îÄ reports_28753/
‚îÇ   ‚îú‚îÄ‚îÄ reports_79021/
‚îÇ   ‚îú‚îÄ‚îÄ reports_98911/
‚îÇ   ‚îî‚îÄ‚îÄ reports_99617/
‚îÇ
‚îî‚îÄ‚îÄ cross_market_data/
    ‚îú‚îÄ‚îÄ cross_market_28670.csv
    ‚îú‚îÄ‚îÄ cross_market_28753.csv
    ‚îú‚îÄ‚îÄ cross_market_79021.csv
    ‚îú‚îÄ‚îÄ cross_market_98911.csv
    ‚îî‚îÄ‚îÄ cross_market_99617.csv
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è:
- –û–±—Ä–æ–±–ª–µ–Ω–æ: 5 —Ä–∏–Ω–∫—ñ–≤
- –í—Å—å–æ–≥–æ –ø—Ä–µ–ø–∞—Ä–∞—Ç—ñ–≤: 775
- CRITICAL: 427 (55%), SUBSTITUTABLE: 348 (45%)
- –†—è–¥–∫—ñ–≤ —É –∑–≤—ñ—Ç–∞—Ö: ~7,186
- –ß–∞—Å –æ–±—Ä–æ–±–∫–∏: ~13 —Å–µ–∫ (–≤—Å—ñ —Ä–∏–Ω–∫–∏)

### –û–Ω–æ–≤–ª–µ–Ω—ñ —Ñ–∞–π–ª–∏:
- `exec_scripts/02_05_reports_cross_market.py` (–ù–û–í–ò–ô)
- `docs/_values_describe/05_stats_reports_value.md` (–ù–û–í–ò–ô)
- `docs/00_ai_rules/03_PROJECT_MAP.md` (v1.8)
- `docs/_project_history/00_WORK_HISTORY.md` (v1.6)

### –°—Ç–∞—Ç—É—Å: ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û (Phase 1 –ø–æ–≤–Ω—ñ—Å—Ç—é –∑–∞–≤–µ—Ä—à–µ–Ω–æ!)
### –ù–∞—Å—Ç—É–ø–Ω–∏–π –∫—Ä–æ–∫: Phase 2 ‚Äî Cross-Market Aggregation

---

## 2026-01-28 - Phase 1 Step 4: Substitute Analysis ‚úÖ

### –í–∏–∫–æ–Ω–∞–Ω–æ:
- –°—Ç–≤–æ—Ä–µ–Ω–æ —Å–∫—Ä–∏–ø—Ç `exec_scripts/02_04_substitute_analysis.py`
- –†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ SUBSTITUTE_SHARE –¥–ª—è –∫–æ–∂–Ω–æ—ó –ø–∞—Ä–∏ (stockout_drug, substitute)
- –§–æ—Ä–º—É–ª–∏:
  - `LIFT = max(0, ACTUAL - EXPECTED)`
  - `EXPECTED = SALES_PRE √ó MARKET_GROWTH`
  - `SUBSTITUTE_SHARE = TOTAL_LIFT / INTERNAL_LIFT √ó 100%`
- Zero-LIFT Filter: –≤—ñ–¥—Ñ—ñ–ª—å—Ç—Ä–æ–≤–∞–Ω–æ substitutes –∑ TOTAL_LIFT = 0
- –†–æ–∑–¥—ñ–ª–µ–Ω–Ω—è –Ω–∞ SAME_NFC1 —Ç–∞ DIFF_NFC1
- –í–∞–ª—ñ–¥–∞—Ü—ñ—è: —Å—É–º–∞ SUBSTITUTE_SHARE = 100% –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ stockout drug
- –ü—Ä–æ—Ç–µ—Å—Ç–æ–≤–∞–Ω–æ –Ω–∞ –≤—Å—ñ—Ö 5 —Ä–∏–Ω–∫–∞—Ö

### Output:
```
data/processed_data/01_per_market/{CLIENT_ID}/04_substitute_shares_{CLIENT_ID}/
‚îú‚îÄ‚îÄ substitute_shares_{CLIENT_ID}.csv      # LIFT —Ç–∞ SHARE per substitute
‚îî‚îÄ‚îÄ _stats/
    ‚îú‚îÄ‚îÄ substitute_summary_{CLIENT_ID}.csv # –ó–≤–µ–¥–µ–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
    ‚îî‚îÄ‚îÄ substitute_metadata_{CLIENT_ID}.csv # –ü–∞—Ä–∞–º–µ—Ç—Ä–∏ —Ç–∞ –º–µ—Ç–∞–¥–∞–Ω—ñ
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è:
- –û–±—Ä–æ–±–ª–µ–Ω–æ: 5 —Ä–∏–Ω–∫—ñ–≤
- –í—Å—å–æ–≥–æ –ø–∞—Ä (stockout, substitute): 8,341
- –ó–∞–≥–∞–ª—å–Ω–∏–π LIFT: 61,158.34 —É–ø–∞–∫.
- –°–µ—Ä–µ–¥–Ω—ñ–π % SAME_NFC1: 78.3%
- –í—ñ–¥—Ñ—ñ–ª—å—Ç—Ä–æ–≤–∞–Ω–æ (LIFT=0): ~10-12%
- –í–∞–ª—ñ–¥–∞—Ü—ñ—è: 100% (–≤—Å—ñ —Å—É–º–∏ SHARE = 100%)

### –û–Ω–æ–≤–ª–µ–Ω—ñ —Ñ–∞–π–ª–∏:
- `exec_scripts/02_04_substitute_analysis.py` (–ù–û–í–ò–ô)
- `docs/_values_describe/04_stats_substitute_value.md` (–ù–û–í–ò–ô)
- `docs/00_ai_rules/03_PROJECT_MAP.md` (v1.7)
- `docs/_project_history/00_WORK_HISTORY.md` (v1.5)

### –°—Ç–∞—Ç—É—Å: ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û
### –ù–∞—Å—Ç—É–ø–Ω–∏–π –∫—Ä–æ–∫: –†–æ–∑—Ä–æ–±–∫–∞ —Å–∫—Ä–∏–ø—Ç—É 02_05_reports_cross_market.py

---

## 2026-01-28 - Phase 1 Step 1: Data Aggregation - Bug Fix üîÑ

### –í–∏–∫–æ–Ω–∞–Ω–æ:
- –í–∏–ø—Ä–∞–≤–ª–µ–Ω–æ bug –≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏—Ü—ñ: –≤–∏–¥–∞–ª–µ–Ω–æ –Ω–µ–∫–æ—Ä–µ–∫—Ç–Ω—ñ —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫–∏ —Ç–∏–∂–Ω—ñ–≤
  - –ü—Ä–∏–±—Ä–∞–Ω–æ DATE_ACTUAL (weeks_with_sales * 7 ‚Äî –¥–∞–≤–∞–ª–æ —Ö–∏–±–Ω—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏)
  - –ü—Ä–∏–±—Ä–∞–Ω–æ SALES_DAYS_RATIO (ratio > 1.0 –¥–ª—è –∫–æ—Ä–æ—Ç–∫–∏—Ö –ø–µ—Ä—ñ–æ–¥—ñ–≤)
  - –ü—Ä–∏–±—Ä–∞–Ω–æ WEEKS_COUNT (–Ω–µ–ø–æ—Ç—Ä—ñ–±–Ω–æ –Ω–∞ –µ—Ç–∞–ø—ñ –∞–≥—Ä–µ–≥–∞—Ü—ñ—ó)
- –ü–µ—Ä–µ–≤—ñ—Ä–µ–Ω–æ –ª–æ–≥—ñ–∫—É –∞–≥—Ä–µ–≥–∞—Ü—ñ—ó –∑ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–º –ø—Ä–æ–µ–∫—Ç–æ–º med_prod_research:
  - –ë–∞–∑–æ–≤–∞ –∞–≥—Ä–µ–≥–∞—Ü—ñ—è (gap filling + weekly aggregation) ‚Äî **–ö–û–†–ï–ö–¢–ù–ê**
  - –ö–æ–ª–æ–Ω–∫–∏ NOTSOLD_PERCENT, MARKET_TOTALS ‚Äî –æ–±—á–∏—Å–ª—é—é—Ç—å—Å—è –Ω–∞ –ø—ñ–∑–Ω—ñ—à–∏—Ö –µ—Ç–∞–ø–∞—Ö
- –ü–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω–æ –∞–≥—Ä–µ–≥–∞—Ü—ñ—é –¥–ª—è –≤—Å—ñ—Ö 5 —Ä–∏–Ω–∫—ñ–≤

### –ù–æ–≤–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:
```
_stats/
‚îú‚îÄ‚îÄ stats_inn_{INN_ID}.csv     # Per DRUGS_ID —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
‚îÇ   ‚îî‚îÄ‚îÄ –ö–æ–ª–æ–Ω–∫–∏: CLIENT_ID, INN_ID, INN_NAME, DRUGS_ID, DRUGS_NAME,
‚îÇ                DATE_START, DATE_END, DATE_DIFF, TOTAL_Q
‚îÇ
‚îú‚îÄ‚îÄ _summary.csv               # –í—Å—ñ DRUGS_ID —Ä–∞–∑–æ–º
‚îî‚îÄ‚îÄ _inn_summary.csv           # –ê–≥—Ä–µ–≥–æ–≤–∞–Ω–æ per INN
    ‚îî‚îÄ‚îÄ –ö–æ–ª–æ–Ω–∫–∏: INN_ID, INN_NAME, DRUGS_COUNT, DATE_START, DATE_END, TOTAL_Q
```

### –†—ñ–∑–Ω–∏—Ü—è –∑ –æ—Ä–∏–≥—ñ–Ω–∞–ª–æ–º:
- **–û—Ä–∏–≥—ñ–Ω–∞–ª** (single-market): aggregated_inn_{ID}.csv –º—ñ—Å—Ç–∏—Ç—å —Ç—ñ–ª—å–∫–∏ TARGET –∞–ø—Ç–µ–∫—É + NOTSOLD + MARKET_TOTALS
- **–ù–∞—à** (multi-market): inn_{INN_ID}_{CLIENT_ID}.csv –º—ñ—Å—Ç–∏—Ç—å –í–°–Ü –∞–ø—Ç–µ–∫–∏ (target + competitors)
- NOTSOLD_PERCENT —Ç–∞ MARKET_TOTALS –±—É–¥—É—Ç—å –æ–±—á–∏—Å–ª–µ–Ω—ñ –Ω–∞ –µ—Ç–∞–ø—ñ stockout detection

### –û–Ω–æ–≤–ª–µ–Ω—ñ —Ñ–∞–π–ª–∏:
- `exec_scripts/02_01_data_aggregation.py` (v1.1 ‚Äî –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞)
- `docs/_project_history/00_WORK_HISTORY.md` (v1.4)

### –°—Ç–∞—Ç—É—Å: ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û
### –ù–∞—Å—Ç—É–ø–Ω–∏–π –∫—Ä–æ–∫: –†–æ–∑—Ä–æ–±–∫–∞ —Å–∫—Ä–∏–ø—Ç—É 02_02_stockout_detection.py

---

## 2026-01-28 - Phase 1 Step 1: Data Aggregation ‚úÖ

### –í–∏–∫–æ–Ω–∞–Ω–æ:
- –°—Ç–≤–æ—Ä–µ–Ω–æ —Å–∫—Ä–∏–ø—Ç `exec_scripts/02_01_data_aggregation.py`
- –†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ –æ–±—Ä–æ–±–∫—É –¥–∞–Ω–∏—Ö per market:
  - –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è raw –¥–∞–Ω–∏—Ö
  - –ü–µ—Ä–µ–π–º–µ–Ω—É–≤–∞–Ω–Ω—è —Ç–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—è –∫–æ–ª–æ–Ω–æ–∫
  - Gap filling –¥–ª—è —á–∞—Å–æ–≤–∏—Ö —Ä—è–¥—ñ–≤
  - –¢–∏–∂–Ω–µ–≤–∞ –∞–≥—Ä–µ–≥–∞—Ü—ñ—è per INN
- –°—Ç–≤–æ—Ä–µ–Ω–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É per INN –¥–ª—è —Ü—ñ–ª—å–æ–≤–æ—ó –∞–ø—Ç–µ–∫–∏
- –û–Ω–æ–≤–ª–µ–Ω–æ `paths_config.py` –¥–ª—è –Ω–æ–≤–æ—ó —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –ø–∞–ø–æ–∫
- –í–∏–ø—Ä–∞–≤–ª–µ–Ω–æ bug –∑ duplicate labels –ø—Ä–∏ gap filling
- –ü—Ä–æ—Ç–µ—Å—Ç–æ–≤–∞–Ω–æ –Ω–∞ –≤—Å—ñ—Ö 5 —Ç–µ—Å—Ç–æ–≤–∏—Ö —Ä–∏–Ω–∫–∞—Ö

### Output:
```
data/processed_data/
‚îú‚îÄ‚îÄ 00_preproc_results/                    # ‚úÖ —ñ—Å–Ω—É—î
‚îÇ
‚îî‚îÄ‚îÄ 01_per_market/                         # === PHASE 1 ===
    ‚îú‚îÄ‚îÄ 28670/
    ‚îÇ   ‚îî‚îÄ‚îÄ 01_aggregation_28670/
    ‚îÇ       ‚îú‚îÄ‚îÄ inn_{INN_ID}_28670.csv     # –ê–≥—Ä–µ–≥–æ–≤–∞–Ω—ñ –¥–∞–Ω—ñ per INN
    ‚îÇ       ‚îî‚îÄ‚îÄ _stats/
    ‚îÇ           ‚îú‚îÄ‚îÄ stats_inn_{INN_ID}.csv # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ per INN
    ‚îÇ           ‚îú‚îÄ‚îÄ _summary.csv           # –ó–≤–µ–¥–µ–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
    ‚îÇ           ‚îî‚îÄ‚îÄ _inn_summary.csv       # –ê–≥—Ä–µ–≥–æ–≤–∞–Ω–∞ per INN
    ‚îÇ
    ‚îú‚îÄ‚îÄ 28753/
    ‚îú‚îÄ‚îÄ 79021/
    ‚îú‚îÄ‚îÄ 98911/
    ‚îî‚îÄ‚îÄ 99617/
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è:
- –û–±—Ä–æ–±–ª–µ–Ω–æ: 5 —Ä–∏–Ω–∫—ñ–≤, 100 INN –≥—Ä—É–ø
- –°—Ç–≤–æ—Ä–µ–Ω–æ: 1,616,335 —Ä—è–¥–∫—ñ–≤ –∞–≥—Ä–µ–≥–æ–≤–∞–Ω–∏—Ö –¥–∞–Ω–∏—Ö
- –ß–∞—Å –æ–±—Ä–æ–±–∫–∏: ~127 —Å–µ–∫ (–≤—Å—ñ —Ä–∏–Ω–∫–∏)

### –û–Ω–æ–≤–ª–µ–Ω—ñ —Ñ–∞–π–ª–∏:
- `exec_scripts/02_01_data_aggregation.py` (–ù–û–í–ò–ô)
- `project_core/data_config/paths_config.py` (–æ–Ω–æ–≤–ª–µ–Ω–æ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–∞–ø–æ–∫)
- `project_core/utility_functions/etl_utils.py` (fix duplicate labels)
- `docs/_project_history/00_WORK_HISTORY.md` (v1.3)
- `docs/00_ai_rules/03_PROJECT_MAP.md` (v1.4)

### –°—Ç–∞—Ç—É—Å: ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û
### –ù–∞—Å—Ç—É–ø–Ω–∏–π –∫—Ä–æ–∫: –†–æ–∑—Ä–æ–±–∫–∞ —Å–∫—Ä–∏–ø—Ç—É 02_02_stockout_detection.py

---

## 2026-01-28 - –°—Ç–≤–æ—Ä–µ–Ω–Ω—è project_core/ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó —Ç–∞ —É—Ç–∏–ª—ñ—Ç ‚úÖ

### –í–∏–∫–æ–Ω–∞–Ω–æ:
- –°—Ç–≤–æ—Ä–µ–Ω–æ —Å—Ç—Ä—É–∫—Ç—É—Ä—É `project_core/` –∑ 3 –ø—ñ–¥–º–æ–¥—É–ª—è–º–∏
- –ê–¥–∞–ø—Ç–æ–≤–∞–Ω–æ —Å–∫—Ä–∏–ø—Ç–∏ –∑ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç—É `med_prod_research`
- –ü–µ—Ä–µ–π–º–µ–Ω–æ–≤–∞–Ω–æ –ø–∞–ø–∫–∏ –¥–ª—è —Å—É–º—ñ—Å–Ω–æ—Å—Ç—ñ –∑ Python imports (–±–µ–∑ —Ü–∏—Ñ—Ä –Ω–∞ –ø–æ—á–∞—Ç–∫—É)
- –ü—Ä–æ—Ç–µ—Å—Ç–æ–≤–∞–Ω–æ –≤—Å—ñ —ñ–º–ø–æ—Ä—Ç–∏ ‚Äî –ø—Ä–∞—Ü—é—é—Ç—å –∫–æ—Ä–µ–∫—Ç–Ω–æ

### Output:
```
project_core/
‚îú‚îÄ‚îÄ __init__.py
‚îÇ
‚îú‚îÄ‚îÄ data_config/                      # –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è –¥–∞–Ω–∏—Ö
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ paths_config.py               # –®–ª—è—Ö–∏, –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å–ø–∏—Å–∫—ñ–≤
‚îÇ   ‚îî‚îÄ‚îÄ column_mapping.py             # –ú–∞–ø–ø—ñ–Ω–≥ –∫–æ–ª–æ–Ω–æ–∫ CSV
‚îÇ
‚îú‚îÄ‚îÄ did_config/                  # –ü–∞—Ä–∞–º–µ—Ç—Ä–∏ –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ stockout_params.py            # –ü–æ—Ä–æ–≥–∏ stock-out detection
‚îÇ   ‚îú‚îÄ‚îÄ classification_thresholds.py  # –ö–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—è –ø—Ä–µ–ø–∞—Ä–∞—Ç—ñ–≤
‚îÇ   ‚îî‚îÄ‚îÄ nfc_compatibility.py          # –ú–∞—Ç—Ä–∏—Ü—è —Å—É–º—ñ—Å–Ω–æ—Å—Ç—ñ NFC1
‚îÇ
‚îî‚îÄ‚îÄ utility_functions/                # –£—Ç–∏–ª—ñ—Ç–∏
    ‚îú‚îÄ‚îÄ __init__.py
    ‚îú‚îÄ‚îÄ etl_utils.py                  # ETL —Ñ—É–Ω–∫—Ü—ñ—ó
    ‚îî‚îÄ‚îÄ did_utils.py                  # DiD —Ñ—É–Ω–∫—Ü—ñ—ó
```

### –ö–ª—é—á–æ–≤—ñ –æ—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ:
- `paths_config.py` ‚Äî –¥–∏–Ω–∞–º—ñ—á–Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å–ø–∏—Å–∫—ñ–≤ –∑ preprocessing
- `classification_thresholds.py` ‚Äî —Ñ—É–Ω–∫—Ü—ñ—è `classify_drug_cross_market()` –¥–ª—è –∫—Ä–æ—Å-—Ä–∏–Ω–∫–æ–≤–æ—ó –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—ó
- `did_utils.py` ‚Äî —Ñ—É–Ω–∫—Ü—ñ—è `aggregate_cross_market()` –¥–ª—è –∞–≥—Ä–µ–≥–∞—Ü—ñ—ó –ø–æ —Ä–∏–Ω–∫–∞—Ö

### –û–Ω–æ–≤–ª–µ–Ω—ñ —Ñ–∞–π–ª–∏:
- `project_core/*` (–ù–û–í–Ü)
- `docs/00_ai_rules/00_CLAUDE_RULES.md` (v1.3)
- `docs/00_ai_rules/03_PROJECT_MAP.md` (v1.3)
- `docs/_project_history/00_WORK_HISTORY.md` (v1.2)

### –°—Ç–∞—Ç—É—Å: ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û
### –ù–∞—Å—Ç—É–ø–Ω–∏–π –∫—Ä–æ–∫: –†–æ–∑—Ä–æ–±–∫–∞ —Å–∫—Ä–∏–ø—Ç—ñ–≤ Phase 1 (Per-Market Processing)

---

## 2026-01-28 - –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –≤–∏–≤–æ–¥—É preprocessing üîÑ

### –í–∏–∫–æ–Ω–∞–Ω–æ:
- –ó–º—ñ–Ω–µ–Ω–æ —à–ª—è—Ö –≤–∏–≤–æ–¥—É preprocessing: `results/preproc_results/` ‚Üí `data/processed_data/00_preproc_results/`
- –û–Ω–æ–≤–ª–µ–Ω–æ —Å–∫—Ä–∏–ø—Ç `01_preproc.py`
- –û–Ω–æ–≤–ª–µ–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—é (00_CLAUDE_RULES.md, 03_PROJECT_MAP.md)
- –í–∏–¥–∞–ª–µ–Ω–æ —Å—Ç–∞—Ä—É –ø–∞–ø–∫—É `results/preproc_results/`

### –õ–æ–≥—ñ–∫–∞:
- `data/processed_data/` ‚Äî –¥–ª—è –≤—Å—ñ—Ö –ø—Ä–æ–º—ñ–∂–Ω–∏—Ö/–æ–±—Ä–æ–±–ª–µ–Ω–∏—Ö –¥–∞–Ω–∏—Ö
- `results/` ‚Äî —Ç—ñ–ª—å–∫–∏ –¥–ª—è —Ñ—ñ–Ω–∞–ª—å–Ω–∏—Ö –∑–≤—ñ—Ç—ñ–≤ (Excel, –≥—Ä–∞—Ñ—ñ–∫–∏)

### –û–Ω–æ–≤–ª–µ–Ω—ñ —Ñ–∞–π–ª–∏:
- `exec_scripts/01_preproc.py` (OUTPUT_PATH)
- `docs/00_ai_rules/00_CLAUDE_RULES.md` (v1.2)
- `docs/00_ai_rules/03_PROJECT_MAP.md` (v1.2)

### –°—Ç–∞—Ç—É—Å: ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û
### –ù–∞—Å—Ç—É–ø–Ω–∏–π –∫—Ä–æ–∫: –†–æ–∑—Ä–æ–±–∫–∞ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤ –≤ project_core/

---

## 2026-01-27 - Preprocessing: –∑–±—ñ—Ä —Å–ø–∏—Å–∫—ñ–≤ —Ç–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ ‚úÖ

### –í–∏–∫–æ–Ω–∞–Ω–æ:
- –°—Ç–≤–æ—Ä–µ–Ω–æ —Å–∫—Ä–∏–ø—Ç `01_preproc.py` –¥–ª—è –ø–µ—Ä–≤–∏–Ω–Ω–æ—ó –æ–±—Ä–æ–±–∫–∏ –≤—Ö—ñ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö
- –ó—ñ–±—Ä–∞–Ω–æ —Å–ø–∏—Å–æ–∫ —Ü—ñ–ª—å–æ–≤–∏—Ö –∞–ø—Ç–µ–∫ –∑ —É—Å—ñ—Ö CSV —Ñ–∞–π–ª—ñ–≤
- –ó—ñ–±—Ä–∞–Ω–æ —É–Ω—ñ–∫–∞–ª—å–Ω—ñ INN, NFC1, NFC2, DRUGS –ø–æ –≤—Å—ñ—Ö —Ä–∏–Ω–∫–∞—Ö
- –ó–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –∫–æ–∂–Ω–æ–º—É –ª–æ–∫–∞–ª—å–Ω–æ–º—É —Ä–∏–Ω–∫—É
- –ü—Ä–æ—Ç–µ—Å—Ç–æ–≤–∞–Ω–æ –Ω–∞ 5 —Ç–µ—Å—Ç–æ–≤–∏—Ö —Ä–∏–Ω–∫–∞—Ö

### Output:
```
exec_scripts/
‚îî‚îÄ‚îÄ 01_preproc.py

data/processed_data/00_preproc_results/
‚îú‚îÄ‚îÄ target_pharmacies_list.csv   (—Å–ø–∏—Å–æ–∫ CLIENT_ID)
‚îú‚îÄ‚îÄ inn_list.csv                 (INN_ID + INN_NAME)
‚îú‚îÄ‚îÄ nfc1_list.csv                (NFC Code (1))
‚îú‚îÄ‚îÄ nfc2_list.csv                (NFC Code (2))
‚îú‚îÄ‚îÄ drugs_list.csv               (DRUGS_ID + DRUGS_NAME)
‚îî‚îÄ‚îÄ markets_statistics.csv       (—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ä–∏–Ω–∫–∞—Ö)
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ markets_statistics.csv:
| –ö–æ–ª–æ–Ω–∫–∞ | –û–ø–∏—Å |
|---------|------|
| CLIENT_ID | ID —Ü—ñ–ª—å–æ–≤–æ—ó –∞–ø—Ç–µ–∫–∏ |
| FILE_NAME | –ù–∞–∑–≤–∞ CSV —Ñ–∞–π–ª—É |
| COMPETITORS_COUNT | –ö—ñ–ª—å–∫—ñ—Å—Ç—å –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç—ñ–≤ |
| DATA_START | –ü–æ—á–∞—Ç–∫–æ–≤–∞ –¥–∞—Ç–∞ (DD.MM.YYYY) |
| DATA_END | –ö—ñ–Ω—Ü–µ–≤–∞ –¥–∞—Ç–∞ (DD.MM.YYYY) |
| DAYS_RANGE | –ö—ñ–ª—å–∫—ñ—Å—Ç—å –¥–Ω—ñ–≤ |
| WEEKS_RANGE | –ö—ñ–ª—å–∫—ñ—Å—Ç—å —Ç–∏–∂–Ω—ñ–≤ |
| DRUGS_COUNT | –ö—ñ–ª—å–∫—ñ—Å—Ç—å —É–Ω—ñ–∫–∞–ª—å–Ω–∏—Ö –ø—Ä–µ–ø–∞—Ä–∞—Ç—ñ–≤ |
| INN_COUNT | –ö—ñ–ª—å–∫—ñ—Å—Ç—å INN –≥—Ä—É–ø |
| RECORDS_COUNT | –ó–∞–≥–∞–ª—å–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∑–∞–ø–∏—Å—ñ–≤ |

### –û–Ω–æ–≤–ª–µ–Ω—ñ —Ñ–∞–π–ª–∏:
- `exec_scripts/01_preproc.py` (–ù–û–í–ò–ô, v1.0)

### –°—Ç–∞—Ç—É—Å: ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û
### –ù–∞—Å—Ç—É–ø–Ω–∏–π –∫—Ä–æ–∫: –†–æ–∑—Ä–æ–±–∫–∞ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤ –≤ project_core/

---

## 2026-01-27 - –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—ó docs/00_ai_rules/ ‚úÖ

### –í–∏–∫–æ–Ω–∞–Ω–æ:
- –ê–¥–∞–ø—Ç–æ–≤–∞–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—é –∑ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç—É med_prod_research
- –°—Ç–≤–æ—Ä–µ–Ω–æ 5 —Ñ–∞–π–ª—ñ–≤ –ø—Ä–∞–≤–∏–ª —Ç–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É –¥–ª—è AI
- –í—Ä–∞—Ö–æ–≤–∞–Ω–æ —Å–ø–µ—Ü–∏—Ñ—ñ–∫—É –º—É–ª—å—Ç–∏-—Ä–∏–Ω–∫–æ–≤–æ–≥–æ –∞–Ω–∞–ª—ñ–∑—É

### Output:
```
docs/00_ai_rules/
‚îú‚îÄ‚îÄ 00_CLAUDE_RULES.md           (–ø—Ä–∞–≤–∏–ª–∞ —Ä–æ–±–æ—Ç–∏ –∑ –ø—Ä–æ–µ–∫—Ç–æ–º)
‚îú‚îÄ‚îÄ 01_BUSINESS_CONTEXT.md       (–±—ñ–∑–Ω–µ—Å-–∫–æ–Ω—Ç–µ–∫—Å—Ç, –º–µ—Ç—Ä–∏–∫–∏)
‚îú‚îÄ‚îÄ 02_KNOWN_ISSUES.md           (–≤—ñ–¥–æ–º—ñ –ø—Ä–æ–±–ª–µ–º–∏)
‚îú‚îÄ‚îÄ 03_PROJECT_MAP.md            (—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç—É, pipeline)
‚îî‚îÄ‚îÄ 04_DOCUMENTATION_PRINCIPLES.md (–ø—Ä–∏–Ω—Ü–∏–ø–∏ –¥–æ–∫—É–º–µ–Ω—Ç—É–≤–∞–Ω–Ω—è)
```

### –ö–ª—é—á–æ–≤—ñ –∞–¥–∞–ø—Ç–∞—Ü—ñ—ó:
- Pipeline: 4 —Ñ–∞–∑–∏ –∑–∞–º—ñ—Å—Ç—å 5 stages (Per-Market ‚Üí Cross-Market ‚Üí Statistical ‚Üí Reports)
- –ù–æ–≤—ñ –º–µ—Ç—Ä–∏–∫–∏: MARKET_COVERAGE, CROSS_MARKET_STABILITY, CI
- –¢—Ä–∏—Ä—ñ–≤–Ω–µ–≤–∞ –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—è: CRITICAL / MODERATE / SUBSTITUTABLE
- –§–æ—Ä–º–∞—Ç –¥–∞–Ω–∏—Ö: Rd2_{CLIENT_ID}.csv, –ª–æ–≥—ñ–∫–∞ ORG_ID/CLIENT_ID

### –û–Ω–æ–≤–ª–µ–Ω—ñ —Ñ–∞–π–ª–∏:
- `docs/00_ai_rules/*.md` (–ù–û–í–Ü, v1.0)

### –°—Ç–∞—Ç—É—Å: ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û
### –ù–∞—Å—Ç—É–ø–Ω–∏–π –∫—Ä–æ–∫: Preprocessing ‚Äî –∑–±—ñ—Ä —Å–ø–∏—Å–∫—ñ–≤ —Ç–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

---

## 2026-01-27 - –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –ø—Ä–æ–µ–∫—Ç—É ‚úÖ

### –í–∏–∫–æ–Ω–∞–Ω–æ:
- –°—Ç–≤–æ—Ä–µ–Ω–æ –∫–æ—Ä–µ–Ω–µ–≤—É –ø–∞–ø–∫—É `cross_pharm_market_analysis`
- –í–∏–∑–Ω–∞—á–µ–Ω–æ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–∞–ø–æ–∫ –ø—Ä–æ–µ–∫—Ç—É
- –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ 5 —Ç–µ—Å—Ç–æ–≤–∏—Ö CSV —Ñ–∞–π–ª—ñ–≤ –ª–æ–∫–∞–ª—å–Ω–∏—Ö —Ä–∏–Ω–∫—ñ–≤
- –ü—Ä–æ–∞–Ω–∞–ª—ñ–∑–æ–≤–∞–Ω–æ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–∏—Ö (ORG_ID, CLIENT_ID, PERIOD_ID)
- –£–∑–≥–æ–¥–∂–µ–Ω–æ –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—é —Å–∫—Ä–∏–ø—Ç—ñ–≤ –Ω–∞ 3 –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó

### Output:
```
cross_pharm_market_analysis/
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ raw/                     (5 —Ç–µ—Å—Ç–æ–≤–∏—Ö CSV —Ñ–∞–π–ª—ñ–≤)
‚îÇ   ‚îî‚îÄ‚îÄ processed_data/          (–¥–ª—è –º–∞–π–±—É—Ç–Ω—ñ—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤)
‚îÇ
‚îú‚îÄ‚îÄ docs/
‚îÇ   ‚îú‚îÄ‚îÄ 00_ai_rules/
‚îÇ   ‚îî‚îÄ‚îÄ _project_history/
‚îÇ
‚îú‚îÄ‚îÄ exec_scripts/                (–≤–∏–∫–æ–Ω—É–≤–∞–Ω—ñ —Å–∫—Ä–∏–ø—Ç–∏)
‚îÇ
‚îú‚îÄ‚îÄ project_core/                (–∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è —Ç–∞ —É—Ç–∏–ª—ñ—Ç–∏)
‚îÇ   ‚îú‚îÄ‚îÄ data_config/
‚îÇ   ‚îú‚îÄ‚îÄ did_config/
‚îÇ   ‚îî‚îÄ‚îÄ utility_functions/
‚îÇ
‚îî‚îÄ‚îÄ results/
    ‚îú‚îÄ‚îÄ preproc_results/
    ‚îî‚îÄ‚îÄ data_processing_results/
```

### –ö–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—è —Å–∫—Ä–∏–ø—Ç—ñ–≤:
1. **data_config/** ‚Äî ID –∞–ø—Ç–µ–∫, INN –≥—Ä—É–ø–∏, —à–ª—è—Ö–∏, –º–∞–ø–ø—ñ–Ω–≥ –∫–æ–ª–æ–Ω–æ–∫
2. **did_config/** ‚Äî –ø–æ—Ä–æ–≥–∏ stock-out, classification, NFC —Å—É–º—ñ—Å–Ω—ñ—Å—Ç—å
3. **utility_functions/** ‚Äî ETL —Ñ—É–Ω–∫—Ü—ñ—ó, DiD —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫–∏, NFC —Ñ—ñ–ª—å—Ç—Ä

### –í—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ:
- –§–æ—Ä–º–∞—Ç: `Rd2_{CLIENT_ID}.csv`
- –†–æ–∑–¥—ñ–ª—å–Ω–∏–∫: `;`
- CLIENT_ID = —Ü—ñ–ª—å–æ–≤–∞ –∞–ø—Ç–µ–∫–∞
- ORG_ID = –∞–ø—Ç–µ–∫–∞-–ø—Ä–æ–¥–∞–≤–µ—Ü—å (—Ü—ñ–ª—å–æ–≤–∞ –∞–±–æ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç)

### –°—Ç–∞—Ç—É—Å: ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û
### –ù–∞—Å—Ç—É–ø–Ω–∏–π –∫—Ä–æ–∫: –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—ó docs/00_ai_rules/

---
