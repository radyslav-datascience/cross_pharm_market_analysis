# Computing Machine Parameters

## Призначення документу

Цей документ описує параметри обчислювальної машини, на якій виконуються розрахунки пайплайну проекту `cross_pharm_market_analysis`. Ця інформація необхідна для:

1. **Відтворюваності** — при повторенні розрахунків на іншій машині потрібно розуміти на якому обладнанні отримані поточні результати
2. **Конфігурації паралельних обчислень** — кількість workers та обсяг пам'яті на процес залежать від hardware
3. **Діагностики проблем** — якщо розрахунки зайняли занадто багато часу або впали через нестачу пам'яті, потрібно знати обмеження машини

---

## Параметри поточної машини

| Параметр | Значення |
|----------|----------|
| **Тип** | MacBook Pro |
| **Процесор** | 2.6 GHz 6-ядерний Intel Core i7 |
| **Фізичних ядер** | 6 |
| **Логічних ядер** | 12 (Hyper-Threading) |
| **Оперативна пам'ять** | 16 ГБ 2400 MHz DDR4 |
| **Графічний процесор** | Intel UHD Graphics 630 1536 МБ |
| **Диск** | SSD |
| **ОС** | macOS |

---

## Де ці параметри впливають на обчислення

### CPU (процесор)

- **Кількість ядер** визначає максимальну кількість паралельних workers при обчисленні пайплайну
- **Тактова частота** впливає на час виконання одного market (Steps 2–6)
- Для 6-ядерного процесора оптимально **4–5 workers** — залишаємо 1–2 ядра для системних процесів та overhead

### RAM (оперативна пам'ять)

- **16 ГБ** — обмежуючий фактор для паралельних обчислень
- Кожен worker при піковому навантаженні (Step 5: Substitute Analysis з великим ринком) може зайняти **300–500 МБ**
- При 5 workers: ~2.5 ГБ дані + ~3 ГБ overhead per process = ~5.5 ГБ. Безпечний запас для ОС (~10 ГБ)
- **Ризик:** якщо кількість workers > 6 при 16 ГБ RAM — можливий swap на диск, що різко сповільнить обчислення

### Диск (SSD)

- SSD забезпечує швидке читання/запис CSV файлів між кроками пайплайну
- При HDD диску час I/O операцій був би суттєво більшим, і in-memory підхід став би більш доцільним

---

## Конфігуратор параметрів

Параметри обчислювальної машини винесені у файл-конфігуратор:

**`project_core/calculation_parameters_config/machine_parameters.py`**

При виконанні розрахунків на іншій машині необхідно:

1. Відкрити файл конфігуратора
2. Змінити параметри відповідно до характеристик нової машини
3. Звернути особливу увагу на `MAX_WORKERS` та `MEMORY_LIMIT_GB`

Скрипт пайплайну (`exec_scripts/run_full_pipeline.py`) автоматично зчитує параметри з конфігуратора і налаштовує обчислення відповідно.

---

## Рекомендації для інших машин

| RAM | CPU ядер | Рекомендовані workers | Примітка |
|-----|----------|-----------------------|----------|
| 8 ГБ | 4 | 2–3 | Мінімальна конфігурація |
| 16 ГБ | 6 | 4–5 | Поточна конфігурація |
| 16 ГБ | 8 | 5–6 | Обмежений RAM |
| 32 ГБ | 8 | 6–7 | Оптимальна конфігурація |
| 64 ГБ | 12+ | 8–10 | Серверна конфігурація |

**Формула:** `MAX_WORKERS = min(CPU_CORES - 1, RAM_GB // 3)`
